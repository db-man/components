{"version":3,"file":"Detail.js","names":["React","PropTypes","Input","Collapse","PageContext","constants","ddRender","FieldWrapperForDetailPage","StringFormFieldValue","Detail","props","columns","tables","useContext","renderWithDdRender","column","value","renderFn","getColumnRender","rows","refTables","referenceTable","el","defaultValues","createElement","renderStringFieldValue","id","preview","key","inputProps","readOnly","renderFieldValue","type","STRING","BOOL","NUMBER","STRING_ARRAY","renderDebugJson","debugJson","JSON","stringify","items","label","children","TextArea","style","fontSize","split","length","size","className","map","propTypes","object","isRequired","defaultProps"],"sources":["../../../src/components/GetPageBody/Detail.tsx"],"sourcesContent":["/* eslint-disable react/destructuring-assignment, no-console, max-len */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Input, Collapse, CollapseProps } from 'antd';\n\nimport PageContext from '../../contexts/page';\nimport * as constants from '../../constants';\nimport * as ddRender from '../../ddRender/ddRender';\nimport FieldWrapperForDetailPage from '../FieldWrapperForDetailPage';\nimport StringFormFieldValue from '../StringFormFieldValue';\nimport DbColumn from '../../types/DbColumn';\nimport { ValueType } from '../Form';\n\ninterface DetailProps {\n  defaultValues: ValueType;\n  refTables: Record<string, any>;\n}\n\nconst Detail = (props: DetailProps) => {\n  const { columns, tables } = React.useContext(PageContext);\n\n  const renderWithDdRender = (column: DbColumn, value: any) => {\n    const renderFn = ddRender.getColumnRender('type:getPage', column, {\n      column,\n      tables: tables,\n      rows: props.refTables[`ref:${column.referenceTable}:rows`], // eslint-disable-line react/prop-types\n    });\n    if (renderFn) {\n      // @ts-ignore\n      const el = renderFn(value, props.defaultValues);\n      if (el) {\n        return el;\n      }\n    }\n    return <div>No render fn: {value}</div>;\n  };\n\n  const renderStringFieldValue = (column: DbColumn) => {\n    const value = props.defaultValues[column.id];\n\n    if (column['type:getPage']) {\n      return renderWithDdRender(column, value);\n    }\n\n    let preview = false;\n    if (column['type:getPage'] === 'WithPreview') {\n      preview = true;\n    }\n    return (\n      <StringFormFieldValue\n        key={column.id}\n        inputProps={{\n          readOnly: true,\n        }}\n        preview={preview}\n        value={value}\n      />\n    );\n  };\n\n  const renderFieldValue = (column: DbColumn) => {\n    switch (column.type) {\n      case constants.STRING:\n        return renderStringFieldValue(column);\n      case constants.BOOL:\n      case constants.NUMBER:\n      case constants.STRING_ARRAY:\n      default:\n        return renderWithDdRender(column, props.defaultValues[column.id]);\n    }\n  };\n\n  const renderDebugJson = () => {\n    const debugJson = JSON.stringify(props.defaultValues, null, '  ');\n    const items: CollapseProps['items'] = [\n      {\n        key: 'debug-json',\n        label: 'Debug JSON',\n        children: (\n          <Input.TextArea\n            style={{ fontSize: '10px' }}\n            rows={debugJson.split('\\n').length}\n            value={debugJson}\n          />\n        ),\n      },\n    ];\n    return <Collapse size='small' items={items} />;\n  };\n\n  return (\n    <div className='get-page-body-detail-component'>\n      <div>\n        {columns.map((column) => (\n          <FieldWrapperForDetailPage\n            key={column.id}\n            column={column}\n            value={props.defaultValues[column.id]}\n          >\n            {renderFieldValue(column)}\n          </FieldWrapperForDetailPage>\n        ))}\n      </div>\n      {renderDebugJson()}\n    </div>\n  );\n};\n\nDetail.propTypes = {\n  defaultValues: PropTypes.object.isRequired, // eslint-disable-line react/forbid-prop-types\n};\n\nDetail.defaultProps = {};\n\nexport default Detail;\n"],"mappings":"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"}