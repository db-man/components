{"version":3,"file":"NavBar.js","names":["React","Link","utils","constants","getUrlParams","PageContext","NavBar","Component","constructor","args","_defineProperty","columns","dbName","context","filter","column","referenceTable","map","createElement","key","href","render","tableName","action","primaryKey","id","encodeURIComponent","JSON","stringify","aaa","title","githubDb","getGitHubFullPath","localStorage","getItem","LS_KEY_GITHUB_REPO_PATH","validFilename","target","rel","createLink","to","pathname","updateOrGetLink","search","listLink","className","renderReferenceTableLink","getDataUrl","getDataPath","contextType"],"sources":["../../src/components/NavBar.tsx"],"sourcesContent":["// @ts-nocheck\n\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport { utils } from '@db-man/github';\n\nimport * as constants from '../constants';\nimport { getUrlParams } from '../utils';\nimport PageContext from '../contexts/page';\n\n/**\n * This component depends on page context, so only used in Application/Page\n * TODO `id` in URL is used in this component, so not all pages could use this component\n */\nexport default class NavBar extends React.Component {\n  renderReferenceTableLink = () => {\n    const { columns, dbName } = this.context;\n    return columns\n      .filter((column) => column.referenceTable)\n      .map((column) => [\n        `${column.referenceTable}(`,\n        <a\n          key=\"create-link\"\n          href={`/${dbName}/${column.referenceTable}/create`}\n        >\n          Create\n        </a>,\n        ',',\n        <a key=\"list-link\" href={`/${dbName}/${column.referenceTable}/list`}>\n          List\n        </a>,\n        ') | ',\n      ]);\n  };\n\n  render() {\n    const { dbName, tableName, action, primaryKey } = this.context;\n\n    const id = getUrlParams()[primaryKey];\n    const filter = encodeURIComponent(\n      JSON.stringify({\n        [primaryKey]: id,\n      }),\n    );\n\n    // Only when appModes have \"split-table\"\n    const aaa = id ? (\n      <a\n        title=\"GitHub File Path\"\n        href={this.context.githubDb.getGitHubFullPath(\n          `${localStorage.getItem(\n            constants.LS_KEY_GITHUB_REPO_PATH,\n          )}/${dbName}/${tableName}/${utils.validFilename(id)}.json`,\n        )}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        GitHub Path\n      </a>\n    ) : null;\n\n    const createLink = (\n      <Link to={{ pathname: `/${dbName}/${tableName}/create` }}>Create</Link>\n    );\n    const updateOrGetLink = (\n      <Link\n        to={{\n          pathname: `/${dbName}/${tableName}/${\n            action === 'get' ? 'update' : 'get'\n          }`,\n          search: `?${primaryKey}=${id}`,\n        }}\n      >\n        {action === 'get' ? 'Update' : 'Get'}\n      </Link>\n    );\n    const listLink = (\n      <Link\n        to={{\n          pathname: `/${dbName}/${tableName}/list`,\n          search: `?filter=${filter}`,\n        }}\n      >\n        List\n      </Link>\n    );\n\n    return (\n      <div className=\"dm-nav-bar\">\n        NavBar:\n        <span> </span>\n        <span>\n          <span>github</span>\n          <span>(</span>\n          <span>{aaa}</span>\n          <span>)</span>\n        </span>\n        <span> </span>\n        <span>\n          <span>{tableName}</span>\n          <span>( </span>\n          <span>{createLink}</span>\n          <span>,</span>\n          <span>{updateOrGetLink}</span>\n          <span>,</span>\n          <span>{listLink}</span>\n          <span>)</span>\n        </span>\n        <span> | </span>\n        <span>\n          <span>Ref tables</span>\n          <span>: </span>\n          <span>(</span>\n          <span>{this.renderReferenceTableLink()}</span>\n          <span>)</span>\n        </span>\n        <span> | </span>\n        <a\n          title=\"GitHub File Path\"\n          href={this.context.githubDb.getDataUrl(dbName, tableName)}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          {this.context.githubDb.getDataPath(dbName, tableName)}\n        </a>\n        {/* (\n        <a\n          title=\"Commit History\"\n          href={githubUtils.getGitHubHistoryPath(\n            this.context.githubDb.getDataPath(dbName, tableName),\n          )}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          history\n        </a>\n        ) */}\n      </div>\n    );\n  }\n}\n\nNavBar.contextType = PageContext;\n"],"mappings":"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"}