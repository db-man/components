{"version":3,"file":"NavBar.js","names":["React","useContext","Link","utils","constants","getUrlParams","PageContext","NavBar","dbName","tableName","action","primaryKey","githubDb","columns","renderReferenceTableLink","filter","column","referenceTable","map","createElement","key","href","id","encodeURIComponent","JSON","stringify","aaa","title","getGitHubFullPath","localStorage","getItem","LS_KEY_GITHUB_REPO_PATH","validFilename","target","rel","createLink","to","pathname","updateOrGetLink","search","listLink","className","getDataUrl","getDataPath"],"sources":["../../src/components/NavBar.tsx"],"sourcesContent":["import React, { useContext } from 'react';\nimport { Link } from 'react-router-dom';\nimport { utils } from '@db-man/github';\n\nimport * as constants from '../constants';\nimport { getUrlParams } from '../utils';\nimport PageContext from '../contexts/page';\n\n/**\n * This component depends on page context, so only used in Application/Page\n * TODO `id` in URL is used in this component, so not all pages could use this component\n */\nconst NavBar = () => {\n  const { dbName, tableName, action, primaryKey, githubDb, columns } =\n    useContext(PageContext);\n\n  const renderReferenceTableLink = () => {\n    return columns\n      .filter((column) => column.referenceTable)\n      .map((column) => [\n        `${column.referenceTable}(`,\n        <a\n          key='create-link'\n          href={`/${dbName}/${column.referenceTable}/create`}\n        >\n          Create\n        </a>,\n        ',',\n        <a key='list-link' href={`/${dbName}/${column.referenceTable}/list`}>\n          List\n        </a>,\n        ') | ',\n      ]);\n  };\n\n  const id = getUrlParams()[primaryKey];\n  const filter = encodeURIComponent(\n    JSON.stringify({\n      [primaryKey]: id,\n    })\n  );\n\n  // Only when appModes have \"split-table\"\n  const aaa = id ? (\n    <a\n      title='GitHub File Path'\n      href={githubDb?.getGitHubFullPath(\n        `${localStorage.getItem(\n          constants.LS_KEY_GITHUB_REPO_PATH\n        )}/${dbName}/${tableName}/${utils.validFilename(id)}.json`\n      )}\n      target='_blank'\n      rel='noreferrer'\n    >\n      GitHub Path\n    </a>\n  ) : null;\n\n  const createLink = (\n    <Link to={{ pathname: `/${dbName}/${tableName}/create` }}>Create</Link>\n  );\n  const updateOrGetLink = (\n    <Link\n      to={{\n        pathname: `/${dbName}/${tableName}/${\n          action === 'get' ? 'update' : 'get'\n        }`,\n        search: `?${primaryKey}=${id}`,\n      }}\n    >\n      {action === 'get' ? 'Update' : 'Get'}\n    </Link>\n  );\n  const listLink = (\n    <Link\n      to={{\n        pathname: `/${dbName}/${tableName}/list`,\n        search: `?filter=${filter}`,\n      }}\n    >\n      List\n    </Link>\n  );\n\n  return (\n    <div className='dm-nav-bar'>\n      NavBar:\n      <span> </span>\n      <span>\n        <span>github</span>\n        <span>(</span>\n        <span>{aaa}</span>\n        <span>)</span>\n      </span>\n      <span> </span>\n      <span>\n        <span>{tableName}</span>\n        <span>( </span>\n        <span>{createLink}</span>\n        <span>,</span>\n        <span>{updateOrGetLink}</span>\n        <span>,</span>\n        <span>{listLink}</span>\n        <span>)</span>\n      </span>\n      <span> | </span>\n      <span>\n        <span>Ref tables</span>\n        <span>: </span>\n        <span>(</span>\n        <span>{renderReferenceTableLink()}</span>\n        <span>)</span>\n      </span>\n      <span> | </span>\n      <a\n        title='GitHub File Path'\n        href={githubDb?.getDataUrl(dbName, tableName)}\n        target='_blank'\n        rel='noreferrer'\n      >\n        {githubDb?.getDataPath(dbName, tableName)}\n      </a>\n      {/* (\n        <a\n          title=\"Commit History\"\n          href={githubUtils.getGitHubHistoryPath(\n            githubDb.getDataPath(dbName, tableName),\n          )}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          history\n        </a>\n        ) */}\n    </div>\n  );\n};\n\nexport default NavBar;\n"],"mappings":"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"}