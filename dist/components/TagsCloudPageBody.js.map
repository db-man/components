{"version":3,"file":"TagsCloudPageBody.js","names":["React","Link","List","PageContext","TagsCloudPageBody","Component","constructor","props","_defineProperty","setState","loading","content","context","githubDb","getTableRows","dbName","tableName","error","console","state","tagNameCount","forEach","item","tags","name","dataSource","Object","keys","map","count","sort","a","b","createElement","grid","gutter","xs","sm","md","lg","xl","xxl","renderItem","filter","encodeURIComponent","JSON","stringify","Item","className","to","pathname","search","componentDidMount","getDataAsync","render","renderList","contextType"],"sources":["../../src/components/TagsCloudPageBody.tsx"],"sourcesContent":["// @ts-nocheck\n\n/* eslint-disable react/destructuring-assignment, no-console, max-len */\n\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport { List } from 'antd';\n\nimport PageContext from '../contexts/page';\n\nexport default class TagsCloudPageBody extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      content: [],\n    };\n  }\n\n  componentDidMount() {\n    this.getDataAsync();\n  }\n\n  getDataAsync = async () => {\n    try {\n      this.setState({ loading: true });\n      const { content } = await this.context.githubDb.getTableRows(\n        this.context.dbName,\n        this.context.tableName,\n      );\n      this.setState({\n        loading: false,\n        content,\n\n      });\n    } catch (error) {\n      this.setState({ loading: false });\n      console.error(\n        'Failed to get JSON file in TagsCloudPageBody component, error:',\n        error,\n      );\n    }\n  };\n\n  renderList = () => {\n    const { content } = this.state;\n    if (!content) return null;\n\n    // tag name <=> tag count\n    const tagNameCount = {};\n    content.forEach((item) => {\n      if (!item.tags) return;\n      item.tags.forEach((name) => {\n        if (!tagNameCount[name]) {\n          tagNameCount[name] = 0;\n        }\n        tagNameCount[name] += 1;\n      });\n    });\n\n    const dataSource = Object.keys(tagNameCount)\n      .map((name) => ({\n        name,\n        count: tagNameCount[name],\n      }))\n      .sort((a, b) => b.count - a.count);\n\n    return (\n      <List\n        loading={this.state.loading}\n        grid={{\n          gutter: 16,\n          xs: 1,\n          sm: 2,\n          md: 4,\n          lg: 4,\n          xl: 8,\n          xxl: 3,\n        }}\n        dataSource={dataSource}\n        renderItem={(item) => {\n          const filter = encodeURIComponent(\n            JSON.stringify({\n              tags: item.name,\n            }),\n          );\n          return (\n            <List.Item>\n              <div className=\"tags-cloud-item\">\n                <Link\n                  to={{\n                    pathname: `/${this.context.dbName}/${this.context.tableName}/list`,\n                    search: `?filter=${filter}`,\n                  }}\n                >\n                  {item.name}\n                </Link>\n                {' '}\n                :\n                {' '}\n                {item.count}\n              </div>\n            </List.Item>\n          );\n        }}\n      />\n    );\n  };\n\n  render() {\n    return (\n      <div className=\"tags-cloud-page-body-component\">{this.renderList()}</div>\n    );\n  }\n}\n\nTagsCloudPageBody.contextType = PageContext;\n"],"mappings":";;;AAAA;;AAEA;;AAEA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,IAAI,QAAQ,kBAAkB;AACvC,SAASC,IAAI,QAAQ,MAAM;AAE3B,OAAOC,WAAW,MAAM,kBAAkB;AAE1C,eAAe,MAAMC,iBAAiB,SAASJ,KAAK,CAACK,SAAS,CAAC;EAC7DC,WAAWA,CAACC,KAAK,EAAE;IACjB,KAAK,CAACA,KAAK,CAAC;IAACC,eAAA,uBAWA,YAAY;MACzB,IAAI;QACF,IAAI,CAACC,QAAQ,CAAC;UAAEC,OAAO,EAAE;QAAK,CAAC,CAAC;QAChC,MAAM;UAAEC;QAAQ,CAAC,GAAG,MAAM,IAAI,CAACC,OAAO,CAACC,QAAQ,CAACC,YAAY,CAC1D,IAAI,CAACF,OAAO,CAACG,MAAM,EACnB,IAAI,CAACH,OAAO,CAACI,SACf,CAAC;QACD,IAAI,CAACP,QAAQ,CAAC;UACZC,OAAO,EAAE,KAAK;UACdC;QAEF,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOM,KAAK,EAAE;QACd,IAAI,CAACR,QAAQ,CAAC;UAAEC,OAAO,EAAE;QAAM,CAAC,CAAC;QACjCQ,OAAO,CAACD,KAAK,CACX,gEAAgE,EAChEA,KACF,CAAC;MACH;IACF,CAAC;IAAAT,eAAA,qBAEY,MAAM;MACjB,MAAM;QAAEG;MAAQ,CAAC,GAAG,IAAI,CAACQ,KAAK;MAC9B,IAAI,CAACR,OAAO,EAAE,OAAO,IAAI;;MAEzB;MACA,MAAMS,YAAY,GAAG,CAAC,CAAC;MACvBT,OAAO,CAACU,OAAO,CAAEC,IAAI,IAAK;QACxB,IAAI,CAACA,IAAI,CAACC,IAAI,EAAE;QAChBD,IAAI,CAACC,IAAI,CAACF,OAAO,CAAEG,IAAI,IAAK;UAC1B,IAAI,CAACJ,YAAY,CAACI,IAAI,CAAC,EAAE;YACvBJ,YAAY,CAACI,IAAI,CAAC,GAAG,CAAC;UACxB;UACAJ,YAAY,CAACI,IAAI,CAAC,IAAI,CAAC;QACzB,CAAC,CAAC;MACJ,CAAC,CAAC;MAEF,MAAMC,UAAU,GAAGC,MAAM,CAACC,IAAI,CAACP,YAAY,CAAC,CACzCQ,GAAG,CAAEJ,IAAI,KAAM;QACdA,IAAI;QACJK,KAAK,EAAET,YAAY,CAACI,IAAI;MAC1B,CAAC,CAAC,CAAC,CACFM,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAACH,KAAK,GAAGE,CAAC,CAACF,KAAK,CAAC;MAEpC,oBACE7B,KAAA,CAAAiC,aAAA,CAAC/B,IAAI;QACHQ,OAAO,EAAE,IAAI,CAACS,KAAK,CAACT,OAAQ;QAC5BwB,IAAI,EAAE;UACJC,MAAM,EAAE,EAAE;UACVC,EAAE,EAAE,CAAC;UACLC,EAAE,EAAE,CAAC;UACLC,EAAE,EAAE,CAAC;UACLC,EAAE,EAAE,CAAC;UACLC,EAAE,EAAE,CAAC;UACLC,GAAG,EAAE;QACP,CAAE;QACFhB,UAAU,EAAEA,UAAW;QACvBiB,UAAU,EAAGpB,IAAI,IAAK;UACpB,MAAMqB,MAAM,GAAGC,kBAAkB,CAC/BC,IAAI,CAACC,SAAS,CAAC;YACbvB,IAAI,EAAED,IAAI,CAACE;UACb,CAAC,CACH,CAAC;UACD,oBACExB,KAAA,CAAAiC,aAAA,CAAC/B,IAAI,CAAC6C,IAAI,qBACR/C,KAAA,CAAAiC,aAAA;YAAKe,SAAS,EAAC;UAAiB,gBAC9BhD,KAAA,CAAAiC,aAAA,CAAChC,IAAI;YACHgD,EAAE,EAAE;cACFC,QAAQ,EAAG,IAAG,IAAI,CAACtC,OAAO,CAACG,MAAO,IAAG,IAAI,CAACH,OAAO,CAACI,SAAU,OAAM;cAClEmC,MAAM,EAAG,WAAUR,MAAO;YAC5B;UAAE,GAEDrB,IAAI,CAACE,IACF,CAAC,EACN,GAAG,EAAC,GAEL,EAAC,GAAG,EACHF,IAAI,CAACO,KACH,CACI,CAAC;QAEhB;MAAE,CACH,CAAC;IAEN,CAAC;IA9FC,IAAI,CAACV,KAAK,GAAG;MACXT,OAAO,EAAE,KAAK;MACdC,OAAO,EAAE;IACX,CAAC;EACH;EAEAyC,iBAAiBA,CAAA,EAAG;IAClB,IAAI,CAACC,YAAY,CAAC,CAAC;EACrB;EAwFAC,MAAMA,CAAA,EAAG;IACP,oBACEtD,KAAA,CAAAiC,aAAA;MAAKe,SAAS,EAAC;IAAgC,GAAE,IAAI,CAACO,UAAU,CAAC,CAAO,CAAC;EAE7E;AACF;AAEAnD,iBAAiB,CAACoD,WAAW,GAAGrD,WAAW"}