{"version":3,"file":"PhotoList.js","names":["React","PropTypes","List","Button","message","ImageLink","downloadImage","listGrid","gutter","xs","sm","md","lg","xl","xxl","renderItem","item","createElement","Item","url","imgSrc","description","PhotoList","photos","messageApi","contextHolder","useMessage","renderDup","photoMap","forEach","photo","undefined","Object","keys","filter","key","map","join","downloadAll","photoUrls","index","download","length","info","clearInterval","intervalId","window","setInterval","onClick","p","grid","dataSource","propTypes","arrayOf","shape","string","isRequired","defaultProps"],"sources":["../../src/components/PhotoList.tsx"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { List, Button, message } from 'antd';\n\nimport { ImageLink } from './Links';\nimport { downloadImage } from '../utils';\n\nconst listGrid = {\n  gutter: 16,\n  xs: 1,\n  sm: 2,\n  md: 4,\n  lg: 4,\n  xl: 4,\n  xxl: 3,\n};\n\nexport type PhotoType = {\n  url: string;\n  imgSrc: string;\n  description: string;\n};\n\nconst renderItem = (item: PhotoType) => (\n  <List.Item>\n    <ImageLink\n      url={item.url}\n      imgSrc={item.imgSrc}\n      description={item.description}\n    />\n  </List.Item>\n);\n\nconst PhotoList = ({ photos }: { photos: PhotoType[] }) => {\n  const [messageApi, contextHolder] = message.useMessage();\n\n  const renderDup = () => {\n    const photoMap: {\n      [key: string]: number;\n    } = {};\n    photos.forEach((photo) => {\n      if (photoMap[photo.url] === undefined) {\n        photoMap[photo.url] = 0;\n      } else {\n        photoMap[photo.url] += 1;\n      }\n    });\n    return Object.keys(photoMap)\n      .filter((key) => photoMap[key] > 1)\n      .map((key) => photoMap[key])\n      .join(',');\n  };\n\n  // Download photos every 1s\n  const downloadAll = (photoUrls: string[]) => {\n    let index: number = 0;\n\n    function download(): void {\n      if (index < photoUrls.length) {\n        downloadImage(photoUrls[index]);\n        messageApi.info('Download ' + photoUrls[index]);\n        index++;\n      } else {\n        clearInterval(intervalId);\n      }\n    }\n\n    // Run download every 1s\n    const intervalId: number = window.setInterval(download, 1000);\n  };\n\n  return (\n    <div>\n      {contextHolder}\n      {renderDup()}\n      <Button\n        onClick={() => {\n          downloadAll(photos.map((p) => p.url));\n        }}\n      >\n        Download All\n      </Button>\n      <List grid={listGrid} dataSource={photos} renderItem={renderItem} />\n    </div>\n  );\n};\n\nPhotoList.propTypes = {\n  photos: PropTypes.arrayOf(\n    PropTypes.shape({\n      url: PropTypes.string.isRequired,\n      imgSrc: PropTypes.string.isRequired,\n      description: PropTypes.string,\n    })\n  ),\n};\n\nPhotoList.defaultProps = { photos: [] };\n\nexport default PhotoList;\n"],"mappings":"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"}